# vim: ts=4 sw=4 et ft=config smartindent:

# Use hyprviz (GUI app) to change settings
# Wiki: https://wiki.hyprland.org/Configuring/Variables

# FIX FOR CHROME/BRAVE BROWSERS: Check the "Use system title bar and borders"

# Imports
source = ~/.config/hypr/keybinds.conf

# name, resolution, position, scale, extras
#monitor = DP-1, 1920x1080@240, 0x0, 1, bitdepth, 10
monitor = , highrr, auto, 1

# Wallpaper setup
#exec-once = swaybg -o \* -m fill -i ~/.config/wall.png
exec-once = mpvpaper -o "no-audio loop" DP-1 ~/.config/livewall.mp4
# Start the polkit agent (user verification for apps)
exec-once = systemctl --user start my-polkit-agent

# xdg-desktop-portal fixes
#exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd --all

# Fix screensharing
# exec-once = systemctl --user stop xdg-desktop-portal-hyprland xdg-desktop-portal
# exec-once = systemctl --user start xdg-desktop-portal-hyprland
# exec-once = sleep 2 && systemctl --user start xdg-desktop-portal

# Execute on each reload
exec = pkill -15 waybar; waybar
exec = pkill -15 dunst; dunst
exec = pkill -15 mpvpaper; mpvpaper -o "no-audio loop" DP-1 ~/.config/livewall.mp4

# Start apps on login
# exec-once = sleep 2 && nwg-dock-hyprland -l "top" -p "top" -nolauncher -r -mt -40 -i 18
# exec-once = sleep 2 && kitty nvim
exec-once = sleep 2 && kitty
exec-once = sleep 2 && firefox
exec-once = sleep 2 && spotify
exec-once = sleep 2 && vesktop
exec-once = sleep 2 && obsidian
exec-once = sleep 2 && ~/.config/hypr/scripts/play-spotify.sh

# https://wiki.hyprland.org/Configuring/Dwindle-Layout
dwindle {
    pseudotile = true
    force_split = 2
    preserve_split = true
}

general {
    gaps_in = 8
    gaps_out = 16
    resize_on_border = true
    layout = dwindle
    border_size = 2
    col.inactive_border = rgba(333333ff)
    col.active_border = rgba(5e81acff)
}

decoration {
    blur {
        enabled = false
        size = 4
        ignore_opacity = true
        xray = true
    }

    shadow {
        range = 10
        color = rgba(A7CAFFFF)
        color_inactive = rgba(00000050)
    }
}

# Enable blur for the status bar
#blurls = waybar

# https://wiki.hyprland.org/Configuring/Animations/
animations {
    enabled = true

    # From https://easings.net/
    # bezier = name, X0, Y0, X1, Y1
    # Y0 is originally 1.56, but 1.26 looks better
    bezier = easeOutBack, 0.34, 1.26, 0.64, 1

    # animation = name, on/off, speed, curve, style
    animation = workspaces, 1, 3, easeOutBack, slide
    animation = windows, 1, 3, easeOutBack, slide
    animation = fade, 1, 3, easeOutBack
    animation = border, 0, 3, easeOutBack
    animation = borderangle, 0, 3, easeOutBack, loop
}

input {
    # hyprland doesn't use the keyboard settings from nix
    # except for the custom layouts
    kb_model = pc104
    kb_layout = us,bgd
    kb_variant = dvorak,
    kb_options = grp:shifts_toggle,ctrl:swapcaps

    repeat_rate = 50
    repeat_delay = 300
    sensitivity = -0.75
    accel_profile = flat
    follow_mouse = 2
    float_switch_override_focus = 0
}

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = 0
    disable_autoreload = true
    vrr = 0
    mouse_move_enables_dpms = true
    key_press_enables_dpms = true
}

xwayland {
    force_zero_scaling = true
}

# https://wiki.hyprland.org/Configuring/Window-Rules/

# make all windows floting by default
windowrulev2 = float, class:.*

# center floating windows and respect the status bar
windowrulev2 = center 1, class:.*

# tiled windows
windowrulev2 = tile, class:^(kitty)$
windowrulev2 = tile, class:^(firefox)$
windowrulev2 = tile, class:^(obsidian)$
windowrulev2 = tile, class:^(vesktop)$
windowrulev2 = tile, initialTitle:^(Spotify)
windowrulev2 = tile, class:^(org.keepassxc.KeePassXC)$
windowrulev2 = tile, class:^(hyprviz)$

# relocate to a workspace
windowrulev2 = workspace 1 silent, class:^(kitty)$
windowrulev2 = workspace 2 silent, class:^(firefox)$
windowrulev2 = workspace 3 silent, class:^(obsidian)$
windowrulev2 = workspace 4 silent, class:^(vesktop)$
windowrulev2 = workspace 5 silent, title:^(Spotify)
windowrulev2 = workspace 5 silent, initialTitle:^(Spotify)

# opacity
windowrulev2 = opacity 0.95, class:^(vesktop)$
windowrulev2 = opacity 0.9, initialTitle:^(Spotify)

# size
# windowrulev2 = size 97% 93%, class:^(vesktop)$
windowrulev2 = size 60% 60%, class:^(thunar)$